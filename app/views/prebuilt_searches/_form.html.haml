= form_for(@prebuilt_search, remote: true) do |f|
  - element_options = f.object.institution.registered_elements.order(:label).map{ |e| [e.label, e.id] }

  .error-messages
    -# populated via ajax by shared/_validation_messages.js.erb

  = f.hidden_field :institution_id, value: f.object.institution_id

  .mb-3
    = f.label :name
    = f.text_field :name, class: "form-control"

  .mb-3
    = label_tag "Elements"
    = hidden_field_tag "prebuilt_search_elements[][registered_element_id]"
    = hidden_field_tag "prebuilt_search_elements[][term]"
    - elements = f.object.elements
    - elements = [PrebuiltSearchElement.new] if elements.empty?
    - elements.each do |element|
      .row.input-group.mb-3
        .col-sm-5
          = select_tag "prebuilt_search_elements[][registered_element_id]",
                       options_for_select(element_options, element.registered_element_id),
                       class: "form-select"
        .col-sm-6
          = text_field_tag "prebuilt_search_elements[][term]",
                           element.term,
                           class: "form-control"
        .col-sm-1
          %button.btn.btn-outline-danger.remove{type: "button"}
            %i.fa.fa-minus
    %button.btn.btn-outline-success.add{type: "button"}
      %i.fa.fa-plus

  .mb-3
    = f.label :ordering_element_id, "Order By"
    = f.select :ordering_element_id,
               options_for_select(element_options, f.object.ordering_element_id),
               { include_blank: true },
               { class: "form-select" }

  .mb-3
    .form-check
      = f.radio_button(:direction,
                       PrebuiltSearch::OrderingDirection::ASCENDING,
                       class: "form-check-input")
      = f.label(:direction,
                PrebuiltSearch::OrderingDirection.label(PrebuiltSearch::OrderingDirection::ASCENDING),
                for: "prebuilt_search_direction_0")
    .form-check
      = f.radio_button(:direction,
                       PrebuiltSearch::OrderingDirection::DESCENDING,
                       class: "form-check-input")
      = f.label(:direction,
                PrebuiltSearch::OrderingDirection.label(PrebuiltSearch::OrderingDirection::DESCENDING),
                for: "prebuilt_search_direction_1")

  .clearfix
    .float-end
      %button.btn.btn-light{"data-bs-dismiss": "modal", type: "button"} Cancel
      = f.submit(f.object.new_record? ? "Create Prebuilt Search" : "Save Changes",
                 class: "btn btn-primary")
