.btn-group.float-end{role: "group"}
  - if policy(@institution).edit_authentication?
    - if @institution.sso_federation == Institution::SSOFederation::OPENATHENS
      -# Refresh OpenAthens Metadata button
      = link_to(institution_refresh_openathens_metadata_path,
                class: "btn btn-light", method: :patch) do
        %i.fa.fa-sync
        Refresh OpenAthens Metadata
    -# Edit button
    %button.btn.btn-light.edit-authentication{"data-bs-target":       "#edit-authentication-modal",
                                              "data-bs-toggle":       "modal",
                                              type:                   "button",
                                              "data-institution-key": @institution.key }
      %i.fa.fa-pencil-alt
      Edit

.clearfix.mb-3

%dl
  - if @institution.key == "uiuc"
    %dt Organization DN
    %dd
      - if @institution.shibboleth_org_dn.present?
        %code= @institution.shibboleth_org_dn
      - else
        Not Set
  - else
    %dt SSO Federation
    %dd
      - if @institution.sso_federation.present?
        = Institution::SSOFederation.label_for(@institution.sso_federation)
      - else
        = boolean(false, style: :word, false_value: "NOT SET")
    %dt IdP Entity ID
    %dd
      - if @institution.saml_idp_entity_id.present?
        %code= @institution.saml_idp_entity_id
      - else
        = boolean(false, style: :word, false_value: "NOT SET")
    %dt SP Entity ID
    %dd
      %code= @institution.saml_sp_entity_id
    %dt SP Metadata URL
    %dd
      - if @institution.saml_idp_entity_id.present?
        = link_to("#{@institution.scope_url}/auth/saml/metadata",
                  "#{@institution.scope_url}/auth/saml/metadata")
      - else
        = boolean(false, style: :word, false_value: "NOT AVAILABLE")
    %dt Email Attribute
    %dd
      - if @institution.saml_email_attribute.present?
        %code= @institution.saml_email_attribute
      - else
        = boolean(false, style: :word, false_value: "NOT SET")
    %dt First Name Attribute
    %dd
      - if @institution.saml_first_name_attribute.present?
        %code= @institution.saml_first_name_attribute
      - else
        = boolean(false, style: :word, false_value: "NOT SET")
    %dt Last Name Attribute
    %dd
      - if @institution.saml_last_name_attribute.present?
        %code= @institution.saml_last_name_attribute
      - else
        = boolean(false, style: :word, false_value: "NOT SET")

- if @institution.key != "uiuc"
  %dl
    %dt SSO Service URL
    %dd
      - if @institution.saml_idp_sso_service_url.present?
        = link_to(@institution.saml_idp_sso_service_url,
                  @institution.saml_idp_sso_service_url)
      - else
        Not Set
    %dt IdP Certificate
    %dd
      - if @institution.saml_idp_cert.present?
        - begin
          - cert = OpenSSL::X509::Certificate.new(@institution.saml_idp_cert)
          %dl
            %dt Subject
            %dd
              %code= cert.subject
            %dt Issuer
            %dd
              %code= cert.issuer
            %dt Issued
            %dd= cert.not_before
            %dt Expires
            %dd= cert.not_after
        - rescue
          = boolean(false, style: :word, false_value: "INVALID")
      - else
        = boolean(false, style: :word, false_value: "NOT SET")