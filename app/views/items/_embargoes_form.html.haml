-# frozen_string_literal: true
-#
-# Required arguments:
-#
-# item [Item]
-#

= form_for(item, remote: true) do |f|
  .error-messages
    -# populated via ajax by shared/_validation_messages.js.erb

  -# Include this only because `item` is required in the params.
  = f.hidden_field :id, value: f.object.id
  -# Tells the controller we are updating embargoes even if none are present,
  -# i.e. we are deleting all of them.
  = hidden_field_tag "embargoes[0][kind]", nil

  - embargoes = item.current_embargoes.order(:expires_at)
  - if embargoes.any?
    - embargoes.each_with_index do |embargo, index|
      = embargoes_form_card(embargo: embargo, index: index)
  - else
    = embargoes_form_card(institution: f.object.institution)

  %button.btn.btn-outline-success.btn-sm.add-embargo{type: "button"}
    %i.fa.fa-plus
    Add Embargo

  .clearfix
    .float-end
      %button.btn.btn-light{"data-bs-dismiss": "modal", type: "button"} Cancel
      = f.submit("Save Changes", class: 'btn btn-primary')
