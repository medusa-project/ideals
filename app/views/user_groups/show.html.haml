- provide :body_id, "show_user_group"
- provide :title, @user_group.name

- can_edit = policy(@user_group).edit?

.btn-group.float-right{role: "group"}
  - if can_edit
    -# Edit button
    %button.btn.btn-light.edit-user-group{"data-target": "#edit-user-group-modal",
                                          "data-toggle": "modal",
                                          "data-user-group-id": @user_group.id,
                                          type: "button"}
      %i.fa.fa-pencil-alt
      Edit
  - if policy(@user_group).destroy?
    -# Delete button
    = link_to(user_group_path(@user_group), class: "btn btn-danger",
                                            role: "button",
                                            method: :delete,
                                            data: { confirm: "Are you sure you want to delete this user group?" }) do
      %i.fa.fa-trash
      Delete

%h1= @user_group.name

.alert.alert-light
  %i.fa.fa-info-circle
  All categories are related by Boolean "OR" except departments and affiliations, which are related by "AND."

.row.mb-3
  .col-sm-12
    .card
      .card-body
        - if can_edit
          .float-right
            %button.btn.btn-light.btn-sm.edit-ad-groups{"data-target": "#edit-ad-groups-modal",
                                                        "data-toggle": "modal",
                                                        "data-user-group-id": @user_group.id,
                                                        type: "button"}
              %i.fa.fa-pencil-alt
              Edit
        %h4.card-title AD Groups
        - if @ldap_groups.any?
          %ul
            - @ldap_groups.each do |group|
              %li
                %strong= group.short_name
                %br
                %code.text-secondary= group.urn
        - else
          %p None

.row.mb-3
  .col-sm-6
    .card
      .card-body
        - if can_edit
          .float-right
            %button.btn.btn-light.btn-sm.edit-local-users{"data-target": "#edit-local-users-modal",
                                                          "data-toggle": "modal",
                                                          "data-user-group-id": @user_group.id,
                                                          type: "button"}
              %i.fa.fa-pencil-alt
              Edit
        %h4.card-title Local Users
        - if @users.any?
          %ul
            - @users.each do |user|
              %li= link_to(user.name, user.becomes(User))
        - else
          %p None
  .col-sm-6
    .card
      .card-body
        - if can_edit
          .float-right
            %button.btn.btn-light.btn-sm.edit-hosts{"data-target": "#edit-hosts-modal",
                                                    "data-toggle": "modal",
                                                    "data-user-group-id": @user_group.id,
                                                    type: "button"}
              %i.fa.fa-pencil-alt
              Edit
        %h4.card-title Hosts
        - if @hosts.any?
          %ul
            - @hosts.each do |group|
              %li
                %code= group.pattern
        - else
          %p None

.row
  .col-sm-6
    .card
      .card-body
        - if can_edit
          .float-right
            %button.btn.btn-light.btn-sm.edit-departments{"data-target": "#edit-departments-modal",
                                                          "data-toggle": "modal",
                                                          "data-user-group-id": @user_group.id,
                                                          type: "button"}
              %i.fa.fa-pencil-alt
              Edit
        %h4.card-title Departments
        - if @departments.any?
          %ul
            - @departments.each do |department|
              %li= department.name
        - else
          %p None
  .col-sm-6
    .card
      .card-body
        - if can_edit
          .float-right
            %button.btn.btn-light.btn-sm.edit-affiliations{"data-target": "#edit-affiliations-modal",
                                                           "data-toggle": "modal",
                                                           "data-user-group-id": @user_group.id,
                                                           type: "button"}
              %i.fa.fa-pencil-alt
              Edit
        %h4.card-title Affiliations
        .alert.alert-light
          %i.fa.fa-info-circle
          These are only considered when there are one or more departments associated with the group.
        - if @affiliations.any?
          %ul
            - @affiliations.each do |affiliation|
              %li= affiliation.name
        - else
          %p None

= render partial: "shared/ajax_modal",
         locals: { id: "edit-user-group-modal", title: "Edit User Group" }
= render partial: "shared/ajax_modal",
         locals: { id: "edit-ad-groups-modal", title: "Edit AD Groups", size: :lg }
= render partial: "shared/ajax_modal",
         locals: { id: "edit-affiliations-modal", title: "Edit Affiliations" }
= render partial: "shared/ajax_modal",
         locals: { id: "edit-departments-modal", title: "Edit Departments" }
= render partial: "shared/ajax_modal",
         locals: { id: "edit-local-users-modal", title: "Edit Local Users" }
= render partial: "shared/ajax_modal",
         locals: { id: "edit-hosts-modal", title: "Edit Hosts" }
