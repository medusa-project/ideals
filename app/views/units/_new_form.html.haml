-# Accepts the following locals:
-#
-# @param parent_id [Integer] Optional parent unit ID.
-#

- parent_id = nil unless defined?(parent_id)

= form_for(@unit, remote: true) do |f|
  .error-messages
    -# populated via ajax by shared/_validation_messages.js.erb

  = f.hidden_field :institution_id, value: f.object.institution.id
  = f.hidden_field :parent_id, value: parent_id

  .mb-3
    = f.label :title
    = f.text_field :title, class: "form-control"

  - unless parent_id
    .mb-3
      = f.label :parent_id, "Parent Unit"
      = f.select(:parent_id,
          options_for_select(unit_tree_options(institution: f.object.institution, include_root: true, include_only_admin: true),
          f.object.parent&.id),
          {}, { class: "form-select" })

  %p.form-text
    = icon_for(:info)
    Access control and other properties can be changed after the unit has
    been created.

  .clearfix
    .float-end
      %button.btn.btn-light{"data-bs-dismiss": "modal", type: "button"} Cancel
      = f.submit "Create Unit", class: "btn btn-primary"
