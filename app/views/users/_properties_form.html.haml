-# frozen_string_literal: true
-#
-# N.B.: this form is for editing only, as User instances can only be created
-# by logging in.
-#
-# Required locals:
-#
-# user [User]
-#
= form_for(user.becomes(User), url: user_update_properties_path(user), remote: true) do |f|
  .error-messages
    -# populated via ajax by shared/_validation_messages.js.erb

  -# For ShibbolethUsers, all of these properties are provided by AD.
  .mb-3
    = f.label :name
    = f.text_field :name, class: "form-control", disabled: !user.kind_of?(LocalUser)
  .mb-3
    = f.label :email
    = f.email_field :email, class: "form-control", disabled: !user.kind_of?(LocalUser)
  .mb-3
    = f.label :phone
    = f.phone_field :phone, class: "form-control", disabled: !user.kind_of?(LocalUser)

  - if policy(user.becomes(User)).change_institution?
    .mb-3
      = f.label :institution
      = f.select(:institution_id, options_for_select(Institution.all.order(:name).map{ |i| [i.name, i.id] }, f.object.institution_id),
                 { include_blank: true },
                 { class: "form-select" })

  .clearfix
    .float-end
      %button.btn.btn-light{"data-bs-dismiss": "modal", type: "button"} Cancel
      = f.submit("Save Changes", class: "btn btn-primary")
